<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">3.14 Relevant Attacks and Countermeasures | Chia Documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://cpp6d.github.io/chia-docs//docs/03consensus/attacks_and_countermeasures"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="3.14 Relevant Attacks and Countermeasures | Chia Documentation"><meta data-react-helmet="true" name="description" content="Majority attack"><meta data-react-helmet="true" property="og:description" content="Majority attack"><link data-react-helmet="true" rel="shortcut icon" href="/img/chia_leaf_green.svg"><link data-react-helmet="true" rel="canonical" href="https://cpp6d.github.io/chia-docs//docs/03consensus/attacks_and_countermeasures"><link data-react-helmet="true" rel="alternate" href="https://cpp6d.github.io/chia-docs//docs/03consensus/attacks_and_countermeasures" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://cpp6d.github.io/chia-docs//docs/03consensus/attacks_and_countermeasures" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.864117c7.css">
<link rel="preload" href="/assets/js/runtime~main.73889518.js" as="script">
<link rel="preload" href="/assets/js/main.7dba6002.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/chia-docs-icon.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/chia-docs-icon.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title"> Chia Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/01introduction/what-is-chia">Docs</a><a href="https://www.chia.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia.net</a><a href="https://github.com/Chia-Network/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia Github</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_CDc6"><kbd class="searchHint_2RRg">ctrl</kbd><kbd class="searchHint_2RRg">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">1 - Introduction</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">2 - Architecture</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">3 - Consensus Algorithm</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/consensus_intro">3.1 Chia Consensus Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/proof-of-space">3.2 Proof of Space</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/vdfs">3.3 VDFs</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/challenges">3.4 Challenges</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/signage_points_and_infusion_points">3.5 Signage Points and Infusion Points</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/harvester_algorith">3.6 Harvester Algorithm</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/multiple_blocks">3.7 Multiple Blocks</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/three_vdf_chains">3.8 Three VDF Chains</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/overflow_blocks">3.9 Overflow Blocks and Weight</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/foliage">3.10 Foliage</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/epochs">3.11 Epoch and Difficulty Adjustment</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/light_clients">3.12 Light Clients</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/timelords">3.13 Timelord Algorithm</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/03consensus/attacks_and_countermeasures">3.14 Relevant Attacks and Countermeasures</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/03consensus/analysis">3.15 Analysis</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">4 - Coin Set Model</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">5 - Block Validation</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">6 - Mempool</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">7 - Networking</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">8 - Serialization</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">9 - Keys and Signatures</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">10 - Protocol</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">11 - Pool Protocol</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">12 - RPC APIs</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">13 - Command Line Interface</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">14 - Python Implementation</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">15 - Resources</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>3.14 Relevant Attacks and Countermeasures</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="majority-attack"></a>Majority attack<a class="hash-link" href="#majority-attack" title="Direct link to heading">#</a></h2><p>In a majority attack, an attacker creates an alternate chain which eventually reaches a higher weight than the honest chain, and forces users to re-org. This attack is present on many blockchain networks including Chia&#x27;s, as well as on Proof-of-Work systems. It is colloquially known as a &quot;51% attack&quot; because the attacker must control more than half of the blockchain&#x27;s resources (hashrate for PoW, netspace for PoST) in order to succeed.</p><p>However, Chia&#x27;s consensus makes this attack more complex to evaluate than in Proof-of-Work systems, so we cannot make a flat 51% assumption. In analyzing this attack, there are several variables at play:</p><ul><li>Number of timelords (regardless of speed)<ul><li>The attacker must control at least one timelord for the attack to be possible.</li><li>With exactly one timelord, the attacker can only build one private chain.</li><li>With an unbounded number of timelords, the attacker can build multiple chains simultaneously, keeping the best one while discarding the rest. This allows the attacker to create slots with fewer blocks, giving them a &quot;double-dip&quot; advantage, discussed in detail below.</li></ul></li><li>Timelord speed (regardless of number)<ul><li>If the attacker has a single timelord, the amount of storage required for the attack is directly correlated to the speed of the attacker&#x27;s timelord relative to the speed of the fastest honest timelord on the network.</li><li>For example (ceteris paribus), if the attacker&#x27;s timelord is twice as fast as the fastest honest timelord on the network, then the attacker&#x27;s space will be twice as &quot;valuable.&quot;</li><li>Additionally, the double-dip advantage will increase as the timelord&#x27;s speed increases. However, due to the minimum block requirement, this advantage will hit its maximum limit with a timelord that is somewhat less than twice as fast as the fastest honest timelord on the network. Also, multiple timelords are required to gain any double-dip advantage at all.</li></ul></li><li>Duration of attack<ul><li>For attacks lasting less than one epoch (~4608 blocks or 1 day), we must assume the worst case for the attacker&#x27;s double-dip advantage, based on the speed and number of timelords.</li><li>For attacks lasting one epoch or longer, the minimum double-dip advantage can always be used. This is because the difficulty will adjust during the attack, so the attacker will lose the ability to create slots with fewer blocks.</li></ul></li></ul><p>Before we can evaluate the percentage requirements for various scenarios, we must first calculate the range for the double-dip advantage.</p><p>The paper <a href="https://arxiv.org/pdf/1910.02218.pdf" target="_blank" rel="noopener noreferrer">Proof-of-Stake Longest Chain Protocols: Security vs Predictability</a> outlines the equation to derive the minimum percentage of the network space an attacker would be required to have in order to undertake a majority attack, for chains using between 1 and 10 consecutive blocks with the same challenge. However, Chia uses a larger -- and variable -- amount of consecutive blocks with the same challenge. Because of this, we must solve the equation for two additional values:</p><ul><li><p>16 -- This is the minimum number of blocks in a slot. (See <a title="Section 3.9: Minimum Block Requirement" href="/docs/03consensus/overflow_blocks#minimum-block-requirement">Section 3.9</a> for more info.) In the worst-case scenario, an attacker with an unbounded number of fast timelords could theoretically create a chain that always uses this minimum number, as explained in the next section.</p></li><li><p>32 -- This is the targeted number of blocks per sub-slot. (See <a title="Section 3.4: Challenges" href="/docs/03consensus/challenges">Section 3.4</a> for more info.) There will be some natural variance in this number, but an attacker who does not have the fastest timelord will not be able to manipulate it.</p></li></ul><p>Here&#x27;s the code to solve for these values in Wolfram alpha, where c is the number of consecutive blocks with the same challenge:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#403f53;background-color:#FBFBFB"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#403f53"><span class="token plain">% Wolfram</span></span><span class="token-line" style="color:#403f53"><span class="token plain">% solve </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">q</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c*p</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">ln</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">-p</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">+</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c-1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">ln</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain">-p</span><span class="token punctuation" style="color:rgb(153, 76, 195)">))</span><span class="token plain"> , -ln</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">-p</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c-1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">ln</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain">-p</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain">-1+</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">c-1</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain">*</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token plain">p/</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain">-p</span><span class="token punctuation" style="color:rgb(153, 76, 195)">))</span><span class="token plain">, </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">c</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token number" style="color:rgb(170, 9, 130)">16</span><span class="token plain"> ,f</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain">+q</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#403f53"><span class="token plain">% Solution over the reals: p≈-0.438787 ∧ q≈1.34313 </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">c</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token number" style="color:rgb(170, 9, 130)">32</span><span class="token plain"></span></span><span class="token-line" style="color:#403f53"><span class="token plain">% Solution over the reals:p≈-0.616585 ∧ q≈1.4678 </span><span class="token assign-left variable" style="color:rgb(201, 103, 101)">c</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token number" style="color:rgb(170, 9, 130)">16</span><span class="token plain"></span></span><span class="token-line" style="color:#403f53"><span class="token plain">% </span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain">+1.4678</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0.405219</span><span class="token plain"></span></span><span class="token-line" style="color:#403f53"><span class="token plain">% </span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain">/</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token number" style="color:rgb(170, 9, 130)">1</span><span class="token plain">+1.34313</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(170, 9, 130)">0.4267795</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Using <code>DD</code> to represent the double-dip advantage,</p><ul><li>With a single timelord, <code>DD</code> is always 1 (no advantage), regardless of the timelord&#x27;s speed. This is because the attacker will only be able to build a single private chain.</li><li>With an unbounded number of timelords, <code>DD</code> will exist in a range, such that 1.34313 &lt; <code>DD</code> &lt; 1.4678. This range has a maximum value due to the minimum of 16 blocks per slot.</li></ul><p>In addition to <code>DD</code>, we&#x27;ll use the following variables in our calculations:</p><ul><li><code>SH</code> is the total space of the honest nodes on the network</li><li><code>VH</code> is the speed of the fastest honest timelord (VDF)</li><li><code>SA</code> is the attacker&#x27;s total space</li><li><code>VA</code> is the speed of the attacker&#x27;s timelord (VDF)</li></ul><p>Using these variables, the formula to calculate when an attacker is able to create a chain at the same speed as the honest chain is:</p><p><code>SH * VH = SA * VA * DD</code></p><p>If we normalize the network&#x27;s honest space and fastest timelord to equal 1, then in order for the attack to succeed, the product of the attacker&#x27;s space, timelord speed, and double-dip advantage must be at least 1:</p><p><code>SA * VA * DD &gt;= 1</code></p><p>The formula to calculate the minimum <code>SA</code> then becomes:</p><p><code>SA = 1 / (VA * DD)</code></p><p>Finally, the formula to calculate the minimum netspace percentage required for the attack is:</p><p><code>% = (SA / (1 + SA)) * 100</code></p><p>The following table shows the minimum required proportion of the total netspace an attacker must have in order to succeed in a majority attack. This table is valid for attacks lasting any amount of time, though sometimes it&#x27;s overly conservative for attacks lasting more than one epoch. It uses fixed values for the first two columns.</p><table><thead><tr><th align="center">Number of Timelords</th><th align="center">VA (relative to VH)</th><th align="center">DD</th><th align="center">SA</th><th align="center">Percent of netspace required</th><th align="left">Comment</th></tr></thead><tbody><tr><td align="center">0</td><td align="center">N/A</td><td align="center">1</td><td align="center">∞</td><td align="center">N/A</td><td align="left">Without a timelord, the attack is not possible.</td></tr><tr><td align="center">1</td><td align="center">0.5</td><td align="center">1</td><td align="center">2</td><td align="center">66.7%</td><td align="left">With a 0.5x timelord, the attacker must control twice as much space as the rest of the network combined.</td></tr><tr><td align="center">∞</td><td align="center">0.5</td><td align="center">1.34313</td><td align="center">1.489</td><td align="center">59.8%</td><td align="left">With infinite 0.5x timelords, the attacker gains a double-dip advantage, so less space is required versus having a single timelord of the same speed.</td></tr><tr><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">1</td><td align="center">50.0%</td><td align="left">If the attacker has one timelord that&#x27;s tied with the fastest honest timelord, then the attacker must control more space than the network&#x27;s honest space.</td></tr><tr><td align="center">∞</td><td align="center">1</td><td align="center">1.34313</td><td align="center">0.745</td><td align="center">42.7%</td><td align="left">With infinite timelords tied with the fastest honest timelord on the network, the attacker gains a double-dip advantage.</td></tr><tr><td align="center">1</td><td align="center">2</td><td align="center">1</td><td align="center">0.5</td><td align="center">33.3%</td><td align="left">If the attacker has one timelord that&#x27;s twice as fast as the fastest honest timelord, the attacker must control half as much space as the rest of the network.</td></tr><tr><td align="center">∞</td><td align="center">2</td><td align="center">1.4678</td><td align="center">0.341</td><td align="center">25.4%</td><td align="left">With infinite 2x timelords, the attacker gains the maximum double-dip advantage.</td></tr></tbody></table><p>For attacks lasting longer than one epoch, <code>DD</code> will not exceed 1.34313. In such an attack, the final row from the preceding table will change to the following:</p><table><thead><tr><th align="center">Number of Timelords</th><th align="center">VA (relative to VH)</th><th align="center">DD</th><th align="center">SA</th><th align="center">Percent of netspace required</th><th align="left">Comment</th></tr></thead><tbody><tr><td align="center">∞</td><td align="center">2</td><td align="center">1.34313</td><td align="center">0.372</td><td align="center">27.1%</td><td align="left">If the attack longer than one epoch, the double-dip advantage will be minimized.</td></tr></tbody></table><p>Note that if we continue to increase <code>VA</code>, <code>DD</code> will always remain at 1.4678 for the first table, and 1.34313 for the second table. The percent of netspace required will decrease linearly.</p><p>It is reasonable to assume that if a long-term attack were attempted, the attacker would have access to many timelords, but they wouldn&#x27;t be significantly faster than the fastest honest timelord. Therefore, Chia uses a base line assumption of 42.7% of the netspace required to for the attacker to succeed.</p><p>To reduce the possibility of an attacker gaining access to a fast timelord, Chia network is currently <a href="https://www.businesswire.com/news/home/20211013005324/en/Chia-Partners-With-Supranational-to-Create-Industry-Leading-Proof-of-Space-Time-Security" target="_blank" rel="noopener noreferrer">developing an ASIC timelord</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="extending-many-chains"></a>Extending many chains<a class="hash-link" href="#extending-many-chains" title="Direct link to heading">#</a></h2><p>As discussed in the previous section, if an attacker is making their own private chain, they can choose which block gets infused into the challenge chain, and can therefore try many different infusions, such that they get the best possible chain.</p><p>Due to the average of 32 blocks with the same challenge, the attacker can only try about 32 different combinations (figuring out which block to include in the challenge chain). The exponential branching that results from trying each of these would give a small boost in space for the attacker. For example, someone with 5 PiB can pretend to have 6 or 7 PiB.</p><p>The reason for receiving just a minor boost is because the alternative chains being tried are inferior and less likely to overtake the longest one. This has been analyzed in the <a href="https://arxiv.org/abs/2010.08154" target="_blank" rel="noopener noreferrer">PoSAT paper</a>.</p><p>If there were a new proof of space challenge for every single block, the attacker could multiply their space by a factor of e=2.718, where only 27% would be required to overtake the network. Chia has chosen to mitigate this attack vector by setting the expected number of blocks per sub-slot to 32. This increases the attacker&#x27;s required space to 42.7%.</p><p>However, Chia also chose not to increase the number of blocks per sub-slot to a number greater than 32. Doing so would decrease the time between blocks, which would allow a timelord that is only slightly faster than all others to orphan blocks more easily. As it stands, with 32 blocks per sub-slot, an attacker would need to have a significantly faster timelord than everyone else in order to successfully orphan any blocks.</p><p>Furthermore, the <a href="https://arxiv.org/abs/2010.08154" target="_blank" rel="noopener noreferrer">PoSAT paper</a> shows that increasing the number of blocks per challenge increases security at a very slow rate, so increasing this number slightly does not provide much benefit.</p><p>If the attacker were to manipulate the difficulty, they could change it so that they get fewer reward blocks per slot. Then they could either include or exclude each block, and exponentially extend all chains simultaneously. This would allow the attacker to multiply their space by a small factor. It is not clear whether this attack gains very much, since the attacker must change the difficulty, which requires sacrificing some weight. However, to prevent this attack, there is a requirement that at least 16 reward chain blocks must be created for a challenge block to be included. This brings the attacker&#x27;s required space in the worst case scenario (with unlimited slightly faster timelords) from 27% up to 42.7%, as discussed above.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="chia-space--global-hard-drive-space"></a>Chia space / global hard drive space<a class="hash-link" href="#chia-space--global-hard-drive-space" title="Direct link to heading">#</a></h2><p>There is a concern that if the Chia network does not have a significant amount of space compared to the available free space of hard drive manufacturers or large companies, then it will be vulnerable to long-range attacks. Therefore the more space taken by the Chia network, the more secure the network is.</p><p>We believe this type of attack is unlikely, though. Large data centers and companies with significant amounts of storage tend not to have much <em>unused</em> storage available to hold Chia plots. And the more space that comes onto Chia&#x27;s network, the lower the rewards per TB. With the netspace currently (December 2021) sitting at 35 EiB, companies will find it difficult to justify buying drives or deleting business data. Furthermore, creating a plot requires a fixed amount of upfront time and money (from current calculations, about 1kWh for a k32, or about 10 cents, which is $1 per terabyte).</p><p>The most likely long-term scenario is that rewards per TB will be sufficiently low to discourage people and companies from acquiring new storage just to farm Chia. Most of the new netspace in the future will therefore come from used storage, often from hard disks that otherwise would have been bound for a landfill. This will serve two purposes: preventing the attack laid out here, and keeping Chia green.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="100-attack"></a>100% attack<a class="hash-link" href="#100-attack" title="Direct link to heading">#</a></h2><p>If the difficulty adjustment were triggered every X timelord slots, as opposed to every X blocks, this would allow for a 100% attack, where all farmers collude to constantly decrease or increase the difficulty.</p><p>Under normal operation, there are 32 blocks per slot.</p><p>Under the hypothetical 100% attack:</p><ol><li>The difficulty would be artificially cut in half, temporarily allowing 64 blocks to be created per slot.</li><li>The difficulty would then be artificially increased by 4x, temporarily allowing 16 blocks per slot.</li><li>Repeat step 1.</li></ol><p>The result of this attack would be to create an average of (64+16)/2 = 40 block rewards per slot, a 25% increase in rewards. This is why Chia chose to trigger the difficulty adjustment based on the number of blocks. If this attack were attempted under the current system, it would slow down and speed up the network, but it would not yield any extra rewards.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="short-range-replotting-attack"></a>Short range replotting attack<a class="hash-link" href="#short-range-replotting-attack" title="Direct link to heading">#</a></h2><p>Plotting usually takes a few minutes to a few hours, even on fast hardware, but it is parallelizable and getting faster.</p><p>Someday in the future, an attacker with high-end hardware could begin creating a plot after a signage point is released, and complete the plot before the infusion point. The attacker could then delete the plot after obtaining the quality rating (or after submitting the proof if it&#x27;s eligible). This would allow the attacker to create a plot that automatically passes the filter, effectively allowing them to farm without storing any space. This attack only becomes feasible if it is possible to create a plot in less than 28 seconds (before the infusion).</p><p>If we assume the worst-case scenario of a farmer being able to create a plot instantly,
the question becomes, what is the cost and what is the benefit of the attack?</p><p>The cost is the electricity, memory, hardware and infrastructure needed to create a plot. The electricity required to create a k32 plot is currently around $0.10, or around $1 per TB.</p><p>The benefit would be the same benefit as storing that plot for 80 minutes (the signage point interval times the plot filter constant). This is because the attacker can always create a plot that passes the plot filter. Assuming $5 per year value per terabyte, the value of a 1TB plot for 80 minutes is $0.00094. Therefore with current plotting software and hardware, it is significantly cheaper to store the plots as opposed to recreating them.</p><p>Another way to look at the benefit of this attack: If the attacker can create a plot that always passes the filter, it will be the equivalent of storing 512 plots locally. Which is cheaper, storing 512 plots or running this attack?</p><p>If 1 TB of HDD storage costs $15, it would cost around $750 to purchase enough space to store 512 plots. If we account for a low-end computer on which to run a farmer, the total cost of this system is roughly $1000. Therefore, the replotting attack only becomes economically feasible on a system worth less than $1000. If this attack ever becomes possible, it will likely cost at least an order of magnitude more to run the attack than to store the plots. (And keep in mind, the price of storage tends to fall every year, so the benefit of the attack is constantly decreasing, even as its feasibility is increasing.)</p><p>The plot filter constant is very useful to reduce the amount of disk lookups farmers must do. With a plot filter of 512, Instead of 7-9 disk reads per plot every 9 seconds, farmers only need to do about 7-9 reads for every 80 minutes.</p><p>The downside of the plot filter constant is that it provides a multiplier of replotting benefit to an attacker, so it must not be set too high. With a plot filter constant of 512, 1/512 plots are valid for every challenge. The attacker can then only create plots that pass the filter, therefore not needing to create the other 511/512ths.</p><p>Setting the filter constant to 512 provides a 512x multiplier. If the replotting attack ever becomes economically feasible, one mitigation would be to decrease the filter, thus decreasing the attack&#x27;s benefit. The other mitigation would be to increase the minimum plot size, thus decreasing the feasibility of the attack.</p><p>In any case, this attack will not become feasible until at least 2026, given projected improvements in hardware speed.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="faster-timelord-but-not-51-attack"></a>Faster timelord (but not 51% attack)<a class="hash-link" href="#faster-timelord-but-not-51-attack" title="Direct link to heading">#</a></h2><p>With the fastest timelord in the system, an attacker can more effectively perform a long-range attack: they can expand their space while farming in a private chain.</p><p>If the attacker does not reach a total of 40.5% of space (with the timelord boosting and extending many chains as above), the usefulness of the faster timelord decreases substantially. This is because inclusion and exclusion of blocks does not depend on how fast you can perform the VDF, but instead depends on whether it’s less than the sub-slot iterations. Furthermore, an attacker needs the space of the rest of the network in order to advance, and therefore must release the challenges to the network.</p><p>In certain cases where blocks come very close together, having a faster timelord can allow an attacker to orphan certain blocks, although this does not increase rewards in the short term (it would hurt others, but not benefit the attacker), and has a risk of undermining the network in the long term (orphaning blocks decreases public trust).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="selfish-farming"></a>Selfish Farming<a class="hash-link" href="#selfish-farming" title="Direct link to heading">#</a></h2><p>Selfish farming occurs when an attacker farms blocks in private, and only releases them when they are at risk of being surpassed by the honest chain.</p><p>In Nakamoto PoW this provides significant gains, because at any point at which the miner is ahead of the rest of the network, the rest of the network is wasting their hashpower on a chain that will not win.</p><p>In Chia consensus, a &quot;selfish&quot; farmer could withhold a proof until just before the infusion point, but this would provide zero benefit versus submitting the proof right away. There can be multiple block winners per signage point, so farming is not a zero-sum game as it is in PoW. Furthermore, the timelord cannot accept proofs for an infusion point that has already passed, so farmers are not allowed to stack a large number of proofs to be infused later.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="farmer-bribe-trunk-attack"></a>Farmer bribe trunk attack<a class="hash-link" href="#farmer-bribe-trunk-attack" title="Direct link to heading">#</a></h2><p>An interesting attack explored in the <a href="https://arxiv.org/abs/2010.08154" target="_blank" rel="noopener noreferrer">PoSAT paper</a> is the bribing attack, which takes advantage of the predictability of the elected “leaders” in each slot. The authors analyze a Proof of Stake chain, and argue that when participants know that they are going to win in advance, there is a potential bribing attack.</p><p>In Chia, if participants knew in advance which plots would win, each user could notify an attacker that they&#x27;d be willing to participate in the attack. If the number of participants reached a certain threshold, they could completely re-org the chain (or orphan those who do not participate, censor transactions, etc). This attack does NOT require the majority of the space in the network to participate; it only requires a certain threshold of winners within a short time frame. Furthermore, it is undetectable, since the attacker can make a normal looking chain.</p><p>This problem is not present in this revision of the Chia consensus algorithm. This problem is solved by reducing the predictability: each farmer does not know for sure if their proof of space is fully eligible until the signage point. Therefore an attacker must bribe a large majority of the space to pull off this attack.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="farmer-bribe-foliage-re-org-attack"></a>Farmer bribe foliage re-org attack<a class="hash-link" href="#farmer-bribe-foliage-re-org-attack" title="Direct link to heading">#</a></h2><p>Since blocks are signed by PoSpace keys, a farmer can theoretically sign multiple blocks with the same PoSpace, at the same height. The attack requires a malicious party to bribe farmers with a certain amount of funds for them to provide a signature of an alternate chain. It does not require the attacker to have a faster timelord.</p><p>If the attacker can convince every single farmer N blocks deep to sign, they can revert or reorder any transaction in those N blocks. This attack requires 100% compliance, likely from unwitting participants. As soon as those participants learn of the attack, at least some of them would probably stop. It is therefore only a short-term attack.</p><p>One potential prevention for this attack would be to use fraud proofs. However, these enable other attacks and complicate behavior, so they were not chosen.</p><p>Instead, the solution is simply to wait longer. After 32 blocks (approximately 10 minutes), we can make a reasonable assumption that at least one farmer is following the protocol and not double signing. If 57.4% is non-colluding (the assumption for 42.7% attack resilience), the probability of a reversal after 32 blocks is <code>0.426^32</code> or <code>1.38*10^-12= 0.00000000000138</code>. Furthermore, this attack is detectable, so it is not easy to pull off.</p><p>Each user can choose their own threshold for which they accept a transaction/block as final. For example, in cases where the total network space drops suddenly, users can be more careful and not consider transactions final, in case there is another existing fork, due to a network split.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="orphaning-transaction-blocks-for-transaction-fees"></a>Orphaning transaction blocks for transaction fees<a class="hash-link" href="#orphaning-transaction-blocks-for-transaction-fees" title="Direct link to heading">#</a></h2><p>Transaction blocks are different from non-transaction blocks, since they contain transaction fees. These may surpass block rewards. For example, Ethereum has had created some blocks with 2 eth of rewards and 8 eth of fees. (<a href="https://eips.ethereum.org/EIPS/eip-1559" target="_blank" rel="noopener noreferrer">EIP 1559</a> changes the calculation significantly, so this is just a historical example of what is possible in other chains.)</p><p>In Chia this will be more extreme, since not every block contains transactions. This leads to attacks where the 2nd place farmer ignores the 1st place in an attempt to win the transaction block. If the 2nd block comes less than 28 seconds after the 1st, they do not specify the previous block, and thus the 2nd place cannot orphan the 1st. The 3rd place could orphan both, but nobody would follow this chain since it is shorter.</p><p>However, if there are no blocks within 28 seconds of the 1st block, the 2nd could orphan the 1st, but they would have to convince the next block to farm on their alternate chain. An easier attack would be if the attacker controlled both the 2nd and 3rd, in which case they could ignore the first and still be longer. These orphaning attacks do not allow the attacker to steal rewards, but rather allow the attacker to slightly lower the difficulty. Since they are very situational and require a lot of space, attempting this attack will likely harm the network more than the potential gain to the attacker.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="orphan-rate"></a>Orphan Rate<a class="hash-link" href="#orphan-rate" title="Direct link to heading">#</a></h2><p>In Chia consensus, two competing blocks around the same time can both be included into the blockchain in parallel, without knowing about each other (although at most one can be a transaction block). When multiple blocks are included at the same time, the result is a chain with a higher weight. This means that the orphan rate in Chia will be essentially zero, assuming low network latency. If network latency exceeds the infusion delay (30-40 seconds), then orphaning of a block is almost guaranteed, so it is more of a step-function. This is in contrast with Nakamoto-PoW in which the orphan rate is high if there is network delay, and decreases smoothly as network condition improves, but never reaches zero.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Chia-Network/chia-docs/blob/main/docs/03consensus/attacks_and_countermeasures.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/03consensus/timelords"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 3.13 Timelord Algorithm</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/03consensus/analysis"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">3.15 Analysis »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#majority-attack" class="table-of-contents__link">Majority attack</a></li><li><a href="#extending-many-chains" class="table-of-contents__link">Extending many chains</a></li><li><a href="#chia-space--global-hard-drive-space" class="table-of-contents__link">Chia space / global hard drive space</a></li><li><a href="#100-attack" class="table-of-contents__link">100% attack</a></li><li><a href="#short-range-replotting-attack" class="table-of-contents__link">Short range replotting attack</a></li><li><a href="#faster-timelord-but-not-51-attack" class="table-of-contents__link">Faster timelord (but not 51% attack)</a></li><li><a href="#selfish-farming" class="table-of-contents__link">Selfish Farming</a></li><li><a href="#farmer-bribe-trunk-attack" class="table-of-contents__link">Farmer bribe trunk attack</a></li><li><a href="#farmer-bribe-foliage-re-org-attack" class="table-of-contents__link">Farmer bribe foliage re-org attack</a></li><li><a href="#orphaning-transaction-blocks-for-transaction-fees" class="table-of-contents__link">Orphaning transaction blocks for transaction fees</a></li><li><a href="#orphan-rate" class="table-of-contents__link">Orphan Rate</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Approach</div><ul class="footer__items"><li class="footer__item"><a href="https://www.chia.net/approach" target="_blank" rel="noopener noreferrer" class="footer__link-item">White Paper</a></li></ul></div><div class="col footer__col"><div class="footer__title">Technology</div><ul class="footer__items"><li class="footer__item"><a href="https://www.chia.net/greenpaper" target="_blank" rel="noopener noreferrer" class="footer__link-item">Green Paper</a></li><li class="footer__item"><a href="https://www.chia.net/assets/Chia-New-Consensus-0.9.pdf" target="_blank" rel="noopener noreferrer" class="footer__link-item">Consensus 1.1</a></li></ul></div><div class="col footer__col"><div class="footer__title">Developers</div><ul class="footer__items"><li class="footer__item"><a href="https://www.chia.net/grants" target="_blank" rel="noopener noreferrer" class="footer__link-item">Grants</a></li><li class="footer__item"><a href="https://www.chialisp.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chialisp</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items"><li class="footer__item"><a href="https://chia.net/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About</a></li><li class="footer__item"><a href="https://chia.net/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://chia.net/contact" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2022 Chia Network Inc., Licensed under the <a href="https://github.com/Chia-Network/chia-docs/blob/main/LICENSE" target="_blank">Apache License, Version 2.0</a> | <a href="https://www.chia.net/terms">Terms</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.73889518.js"></script>
<script src="/assets/js/main.7dba6002.js"></script>
</body>
</html>